(function(){  const mapping = {    '#home': 'Home.html',    '#menu': 'Menu.html',    '#about': 'About.html',    '#contact': 'Contact.html',    '#shop': 'Menu.html',    '#cart': 'Cart.html',    '#checkout': 'Checkout.html',    '#register': 'Profile/Profile.html',    '#login': 'Login/index.html',    '#profile': 'Profile/Profile.html',    '#orders': 'Profile/OrderSummary.html',    '#settings': 'Profile/Settings.html'  };  function resolveTarget(href){    if(!href) return null;    if(href.startsWith('#')){      return mapping[href] || null;    }    if(href.endsWith('.html')) return href;    return null;  }  function computeResolvedForLocation(target){    return target;  }  function bindNavs(){    const links = document.querySelectorAll('header nav a, .nav-list a.nav-link, .auth-container a, .profile-nav a, .footer-nav a');    links.forEach(a=>{      const href = a.getAttribute('href');      const target = resolveTarget(href);      if(!target) return;      a.addEventListener('click', function(e){        e.preventDefault();        const li = a.closest('li.nav-item');        if(li){          document.querySelectorAll('li.nav-item').forEach(i=>i.classList.remove('active'));          li.classList.add('active');        }        const resolved = computeResolvedForLocation(target);        window.location.href = resolved;      });    });    document.querySelectorAll('.logout-btn').forEach(btn=>{      btn.addEventListener('click', function(e){        e.preventDefault();        try{ localStorage.removeItem('currentUser'); }catch(e){}        try{ sessionStorage.removeItem('lastOrder'); }catch(e){}        const resolved = computeResolvedForLocation('../Login/index.html');        window.location.href = resolved;      });    });  }  function updateAuthUI(){    try{      const raw = localStorage.getItem('currentUser');      const authContainer = document.querySelector('.auth-container');      if(!authContainer) return;      if(raw){        const user = JSON.parse(raw);        authContainer.innerHTML = '';        const cart = document.createElement('a');        cart.className = 'cart-link';        cart.setAttribute('href','#cart');        cart.innerHTML = '<span class="material-symbols-outlined">shopping_cart</span>';        authContainer.appendChild(cart);        const profile = document.createElement('a');        profile.className = 'profile-link';        profile.setAttribute('href','#profile');        profile.innerHTML = '<span class="material-symbols-outlined">person</span>';        authContainer.appendChild(profile);      } else {        authContainer.innerHTML = '';        const cart = document.createElement('a');        cart.className = 'cart-link';        cart.setAttribute('href','#cart');        cart.innerHTML = '<span class="material-symbols-outlined">shopping_cart</span>';        authContainer.appendChild(cart);        const reg = document.createElement('a');        reg.className = 'auth-link';        reg.setAttribute('href','../Login/index.html');        reg.textContent = 'Register';        authContainer.appendChild(reg);        const sep = document.createElement('span'); sep.className = 'auth-separator';        authContainer.appendChild(sep);        const login = document.createElement('a');        login.className = 'auth-link';        login.setAttribute('href','../Login/index.html');        login.textContent = 'Login';        authContainer.appendChild(login);      }    }catch(e){}  }  function setActiveByPath(){    const curFile = window.location.pathname.split('/').pop().toLowerCase();    if(!curFile) return;    const headerAnchors = document.querySelectorAll('header nav a, .nav-list a.nav-link, li.nav-item a.nav-link');    headerAnchors.forEach(a=>{      const href = a.getAttribute('href');      const target = resolveTarget(href);      if(!target) return;      const targetFile = target.split('/').pop().toLowerCase();      if(targetFile === curFile){        const li = a.closest('li.nav-item');        if(li) li.classList.add('active');        else a.classList.add('active');      }    });  }  document.addEventListener('DOMContentLoaded', function(){    updateAuthUI();    bindNavs();    setActiveByPath();  });})();
